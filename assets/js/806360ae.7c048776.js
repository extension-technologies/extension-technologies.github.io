"use strict";(self.webpackChunkextention_technologies_docs=self.webpackChunkextention_technologies_docs||[]).push([[7775],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||a;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4688:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],l={},s=void 0,c={unversionedId:"tech-stack/mariadb/nodeProvisioning",id:"tech-stack/mariadb/nodeProvisioning",isDocsHomePage:!1,title:"nodeProvisioning",description:"Galera Article//galeracluster.com/library/documentation/node-provisioning.html",source:"@site/docs/tech-stack/mariadb/nodeProvisioning.md",sourceDirName:"tech-stack/mariadb",slug:"/tech-stack/mariadb/nodeProvisioning",permalink:"/docs/tech-stack/mariadb/nodeProvisioning",editUrl:"https://github.com/extension-technologies/extension-technologies.github.io/docs/tech-stack/mariadb/nodeProvisioning.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"mysqldump",permalink:"/docs/tech-stack/mariadb/mysqldump"},next:{title:"size",permalink:"/docs/tech-stack/mariadb/size"}},p=[],u={toc:p};function d(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Galera Article: ",(0,a.kt)("a",{parentName:"p",href:"https://galeracluster.com/library/documentation/node-provisioning.html"},"https://galeracluster.com/library/documentation/node-provisioning.html")),(0,a.kt)("p",null,"Variable view:\nSHOW VARIABLES LIKE '%wsrep_cluster_address%';\nSHOW GLOBAL VARIABLES LIKE '%wsrep_cluster_address%';\nSHOW STATUS LIKE 'wsrep_cluster_size';"),(0,a.kt)("p",null,"Set Variable:\nSET GLOBAL max_error_count=128;"),(0,a.kt)("p",null,"TO ADD A NEW NODE TO CLUSTER\nLink: ",(0,a.kt)("a",{parentName:"p",href:"https://www.globo.tech/learning-center/how-to-add-a-new-node-to-a-galera-replication-cluster-on-ubuntu-14-04-lts/"},"https://www.globo.tech/learning-center/how-to-add-a-new-node-to-a-galera-replication-cluster-on-ubuntu-14-04-lts/")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Clone or make a current database server with mariadb installed")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Make sure you are able to connect with those databases with\nmysql -u root -ppasswwd -h 10.122.0.24")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Copy the /etc/mysql/my.cnf and /etc/mysql/debian.cnf files to current server.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In case of totally new database create user and give permissions for replication\nmysql \u2013u root \u2013p\nCREATE USER \u2018wsrep\u2019@\u2019%\u2019 IDENTIFIED BY \u2018password\u2019;\nCREATE USER \u2018root\u2019@\u2019%\u2019 IDENTIFIED BY \u2018password\u2019;\nGRANT ALL PRIVILEGES ON ",(0,a.kt)("em",{parentName:"p"},".")," TO 'root'@'%' WITH GRANT OPTION;\nFLUSH PRIVIELGES;"))),(0,a.kt)("p",null,'5.Then edit the mysql.cnf file and add the address on the new created node only, other params from new_cluster_setup\nwsrep_cluster_address="gcomm://192.168.0.1,192.168.0.2,192.168.0.3,192.168.0.4,192.168.0.5"'),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"(optional) The database first time replication can take much memory specially if its a new database, either we can setup wsrep donor node, so that the all data will be fetched from that node only.\nNote: do make sure that node 3 doesn't have that much of load.\nwsrep_sst_donor= donornodename")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"restarting the service on the new nodes only\nservice mysql restart")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Test the connection and cluster size\nmysql -u root -p -e \"SHOW STATUS LIKE 'wsrep_cluster_size'\""))),(0,a.kt)("p",null,"TO REMOVE A NODE FROM CLUSTER\nTemp: Just stop the service of that database on the node we are going to remove till we can restart the infra.\nPermanent:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Stop the service of the database on node we are going to remove."),(0,a.kt)("li",{parentName:"ol"},"Now first start restarting the child nodes by changing the mysql.cnf file then at last the master database.")))}d.isMDXComponent=!0}}]);